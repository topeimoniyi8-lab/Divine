var FacebookPixel_RS=function(t){"use strict";var e,n,r,i,o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function a(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function s(t){return t&&Object.prototype.hasOwnProperty.call(t,"default")&&1===Object.keys(t).length?t.default:t}function c(){if(n)return e;n=1;var t=Object.prototype.hasOwnProperty,r=String.prototype.charAt,i=Object.prototype.toString,o=function(t,e){return r.call(t,e)},a=function(e,n){return t.call(e,n)},s=function(t,e){e=e||a;for(var n=[],r=0,i=t.length;r<i;r+=1)e(t,r)&&n.push(String(r));return n};return e=function(t){return null==t?[]:(e=t,"[object String]"===i.call(e)?s(t,o):function(t){return null!=t&&"function"!=typeof t&&"number"==typeof t.length}(t)?s(t,a):function(t,e){e=e||a;var n=[];for(var r in t)e(t,r)&&n.push(String(r));return n}(t));var e}}var u=function(){if(i)return r;i=1;var t=c(),e=Object.prototype.toString,n="function"==typeof Array.isArray?Array.isArray:function(t){return"[object Array]"===e.call(t)},o=function(t){return null!=t&&(n(t)||"function"!==t&&function(t){var n=typeof t;return"number"===n||"object"===n&&"[object Number]"===e.call(t)}(t.length))},a=function(t,e){for(var n=0;n<e.length&&!1!==t(e[n],n,e);n+=1);},s=function(e,n){for(var r=t(n),i=0;i<r.length&&!1!==e(n[r[i]],r[i],n);i+=1);};return r=function(t,e){return(o(e)?a:s).call(this,t,e)}}();const l=a(u);var f={exports:{}};var d={exports:{}};const y=s(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var p;function h(){return p||(p=1,d.exports=(t=t||function(t,e){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==o&&o.crypto&&(n=o.crypto),!n)try{n=y}catch(t){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},i=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),a={},s=a.lib={},c=s.Base={extend:function(t){var e=i(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},u=s.WordArray=c.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||f).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,i=t.sigBytes;if(this.clamp(),r%4)for(var o=0;o<i;o++){var a=n[o>>>2]>>>24-o%4*8&255;e[r+o>>>2]|=a<<24-(r+o)%4*8}else for(var s=0;s<i;s+=4)e[r+s>>>2]=n[s>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=c.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(r());return new u.init(e,t)}}),l=a.enc={},f=l.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push((o>>>4).toString(16)),r.push((15&o).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new u.init(n,e/2)}},d=l.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],i=0;i<n;i++){var o=e[i>>>2]>>>24-i%4*8&255;r.push(String.fromCharCode(o))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new u.init(n,e)}},p=l.Utf8={stringify:function(t){try{return decodeURIComponent(escape(d.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return d.parse(unescape(encodeURIComponent(t)))}},h=s.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=p.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n,r=this._data,i=r.words,o=r.sigBytes,a=this.blockSize,s=o/(4*a),c=(s=e?t.ceil(s):t.max((0|s)-this._minBufferSize,0))*a,l=t.min(4*c,o);if(c){for(var f=0;f<c;f+=a)this._doProcessBlock(i,f);n=i.splice(0,c),r.sigBytes-=l}return new u.init(n,l)},clone:function(){var t=c.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});s.Hasher=h.extend({cfg:c.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new g.HMAC.init(t,n).finalize(e)}}});var g=a.algo={};return a}(Math),t)),d.exports;var t}var g,b;const m=a((g||(g=1,f.exports=(b=h(),function(t){var e=b,n=e.lib,r=n.WordArray,i=n.Hasher,o=e.algo,a=[],s=[];!function(){function e(e){for(var n=t.sqrt(e),r=2;r<=n;r++)if(!(e%r))return!1;return!0}function n(t){return 4294967296*(t-(0|t))|0}for(var r=2,i=0;i<64;)e(r)&&(i<8&&(a[i]=n(t.pow(r,.5))),s[i]=n(t.pow(r,1/3)),i++),r++}();var c=[],u=o.SHA256=i.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],i=n[1],o=n[2],a=n[3],u=n[4],l=n[5],f=n[6],d=n[7],y=0;y<64;y++){if(y<16)c[y]=0|t[e+y];else{var p=c[y-15],h=(p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3,g=c[y-2],b=(g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10;c[y]=h+c[y-7]+b+c[y-16]}var m=r&i^r&o^i&o,v=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),w=d+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&l^~u&f)+s[y]+c[y];d=f,f=l,l=u,u=a+w|0,a=o,o=i,i=r,r=w+(v+m)|0}n[0]=n[0]+r|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+l|0,n[6]=n[6]+f|0,n[7]=n[7]+d|0},_doFinalize:function(){var e=this._data,n=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;return n[i>>>5]|=128<<24-i%32,n[14+(i+64>>>9<<4)]=t.floor(r/4294967296),n[15+(i+64>>>9<<4)]=r,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(u),e.HmacSHA256=i._createHmacHelper(u)}(Math),b.SHA256)),f.exports));var v="FACEBOOK_PIXEL",w="Facebook Pixel";const j=[{destKey:"external_id",sourceKeys:["userId","context.traits.userId","context.traits.id","anonymousId"]},{destKey:"em",sourceKeys:"context.traits.email"},{destKey:"ph",sourceKeys:"context.traits.phone"},{destKey:"ge",sourceKeys:"context.traits.gender"},{destKey:"db",sourceKeys:"context.traits.birthday"},{destKey:"ln",sourceKeys:["context.traits.lastname","context.traits.lastName","context.traits.last_name"]},{destKey:"fn",sourceKeys:["context.traits.firstname","context.traits.firstName","context.traits.first_name"]},{destKey:"ct",sourceKeys:["context.traits.address.city","context.traits.city"]},{destKey:"st",sourceKeys:["context.traits.address.state","context.traits.state"]},{destKey:"zp",sourceKeys:["context.traits.address.zip","context.traits.zip"]},{destKey:"country",sourceKeys:["context.traits.address.country","context.traits.country"]}],S=["email","lastName","firstName","phone","external_id","city","birthday","gender","street","zip","country"],A={LOG:{value:0,method:console.log},INFO:{value:1,method:console.info},DEBUG:{value:2,method:console.debug},WARN:{value:3,method:console.warn},ERROR:{value:4,method:console.error}};class x{constructor(t,e){this.level=+e||A.ERROR.value,this.scope=t||""}setLogLevel(t){if(t&&"string"==typeof t){const e=t.toUpperCase();this.level=A[e]?A[e].value:this.level}}setScope(t){this.scope=t||this.scope}log(...t){this.logBase(t,A.LOG.value)}info(...t){this.logBase(t,A.INFO.value)}debug(...t){this.logBase(t,A.DEBUG.value)}warn(...t){this.logBase(t,A.WARN.value)}error(...t){this.logBase(t,A.ERROR.value)}logBase(t,e){if(this.level<=e){Object.values(A).find(t=>t.value===e).method(...this.getLogData(t))}}getLogData(t){if(Array.isArray(t)&&t.length>0){let e="%c RS SDK";this.scope&&(e=`${e} - ${this.scope}`);e=`${e} %c ${t[0].trim()}`;const n=[];return n.push(e),n.push("font-weight: bold; background: black; color: white;"),n.push("font-weight: normal;"),n.push(...t.slice(1)),n}return t}}var I,_;var O=function(){if(_)return I;_=1;var t,e,n=Object.prototype,r=n.hasOwnProperty,i=n.toString;"function"==typeof Symbol&&(t=Symbol.prototype.valueOf),"function"==typeof BigInt&&(e=BigInt.prototype.valueOf);var o=function(t){return t!=t},a={boolean:1,number:1,string:1,undefined:1},s=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/,c=/^[A-Fa-f0-9]+$/,u={};return u.a=u.type=function(t,e){return typeof t===e},u.defined=function(t){return void 0!==t},u.empty=function(t){var e,n=i.call(t);if("[object Array]"===n||"[object Arguments]"===n||"[object String]"===n)return 0===t.length;if("[object Object]"===n){for(e in t)if(r.call(t,e))return!1;return!0}return!t},u.equal=function(t,e){if(t===e)return!0;var n,r=i.call(t);if(r!==i.call(e))return!1;if("[object Object]"===r){for(n in t)if(!u.equal(t[n],e[n])||!(n in e))return!1;for(n in e)if(!u.equal(t[n],e[n])||!(n in t))return!1;return!0}if("[object Array]"===r){if((n=t.length)!==e.length)return!1;for(;n--;)if(!u.equal(t[n],e[n]))return!1;return!0}return"[object Function]"===r?t.prototype===e.prototype:"[object Date]"===r&&t.getTime()===e.getTime()},u.hosted=function(t,e){var n=typeof e[t];return"object"===n?!!e[t]:!a[n]},u.instance=u.instanceof=function(t,e){return t instanceof e},u.nil=u.null=function(t){return null===t},u.undef=u.undefined=function(t){return void 0===t},u.args=u.arguments=function(t){var e="[object Arguments]"===i.call(t),n=!u.array(t)&&u.arraylike(t)&&u.object(t)&&u.fn(t.callee);return e||n},u.array=Array.isArray||function(t){return"[object Array]"===i.call(t)},u.args.empty=function(t){return u.args(t)&&0===t.length},u.array.empty=function(t){return u.array(t)&&0===t.length},u.arraylike=function(t){return!!t&&!u.bool(t)&&r.call(t,"length")&&isFinite(t.length)&&u.number(t.length)&&t.length>=0},u.bool=u.boolean=function(t){return"[object Boolean]"===i.call(t)},u.false=function(t){return u.bool(t)&&!1===Boolean(Number(t))},u.true=function(t){return u.bool(t)&&!0===Boolean(Number(t))},u.date=function(t){return"[object Date]"===i.call(t)},u.date.valid=function(t){return u.date(t)&&!isNaN(Number(t))},u.element=function(t){return void 0!==t&&"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&1===t.nodeType},u.error=function(t){return"[object Error]"===i.call(t)},u.fn=u.function=function(t){if("undefined"!=typeof window&&t===window.alert)return!0;var e=i.call(t);return"[object Function]"===e||"[object GeneratorFunction]"===e||"[object AsyncFunction]"===e},u.number=function(t){return"[object Number]"===i.call(t)},u.infinite=function(t){return t===1/0||t===-1/0},u.decimal=function(t){return u.number(t)&&!o(t)&&!u.infinite(t)&&t%1!=0},u.divisibleBy=function(t,e){var n=u.infinite(t),r=u.infinite(e),i=u.number(t)&&!o(t)&&u.number(e)&&!o(e)&&0!==e;return n||r||i&&t%e===0},u.integer=u.int=function(t){return u.number(t)&&!o(t)&&t%1==0},u.maximum=function(t,e){if(o(t))throw new TypeError("NaN is not a valid value");if(!u.arraylike(e))throw new TypeError("second argument must be array-like");for(var n=e.length;--n>=0;)if(t<e[n])return!1;return!0},u.minimum=function(t,e){if(o(t))throw new TypeError("NaN is not a valid value");if(!u.arraylike(e))throw new TypeError("second argument must be array-like");for(var n=e.length;--n>=0;)if(t>e[n])return!1;return!0},u.nan=function(t){return!u.number(t)||t!=t},u.even=function(t){return u.infinite(t)||u.number(t)&&t==t&&t%2==0},u.odd=function(t){return u.infinite(t)||u.number(t)&&t==t&&t%2!=0},u.ge=function(t,e){if(o(t)||o(e))throw new TypeError("NaN is not a valid value");return!u.infinite(t)&&!u.infinite(e)&&t>=e},u.gt=function(t,e){if(o(t)||o(e))throw new TypeError("NaN is not a valid value");return!u.infinite(t)&&!u.infinite(e)&&t>e},u.le=function(t,e){if(o(t)||o(e))throw new TypeError("NaN is not a valid value");return!u.infinite(t)&&!u.infinite(e)&&t<=e},u.lt=function(t,e){if(o(t)||o(e))throw new TypeError("NaN is not a valid value");return!u.infinite(t)&&!u.infinite(e)&&t<e},u.within=function(t,e,n){if(o(t)||o(e)||o(n))throw new TypeError("NaN is not a valid value");if(!u.number(t)||!u.number(e)||!u.number(n))throw new TypeError("all arguments must be numbers");return u.infinite(t)||u.infinite(e)||u.infinite(n)||t>=e&&t<=n},u.object=function(t){return"[object Object]"===i.call(t)},u.primitive=function(t){return!t||!("object"==typeof t||u.object(t)||u.fn(t)||u.array(t))},u.hash=function(t){return u.object(t)&&t.constructor===Object&&!t.nodeType&&!t.setInterval},u.regexp=function(t){return"[object RegExp]"===i.call(t)},u.string=function(t){return"[object String]"===i.call(t)},u.base64=function(t){return u.string(t)&&(!t.length||s.test(t))},u.hex=function(t){return u.string(t)&&(!t.length||c.test(t))},u.symbol=function(e){return"function"==typeof Symbol&&"[object Symbol]"===i.call(e)&&"symbol"==typeof t.call(e)},u.bigint=function(t){return"function"==typeof BigInt&&"[object BigInt]"===i.call(t)&&"bigint"==typeof e.call(t)},I=u}();const k=a(O);var T=Object.defineProperty,P=(t,e)=>T(t,"name",{value:e,configurable:!0}),C=P(t=>null!==t&&"object"==typeof t,"isObject"),N=P((t,e,n)=>"function"==typeof n.join?n.join(t):t[0]+e+t[1],"join"),B=P((t,e,n)=>"function"==typeof n.split?n.split(t):t.split(e),"split"),E=P((t,e={},n)=>"function"!=typeof n?.isValid||n.isValid(t,e),"isValid"),q=P(t=>C(t)||"function"==typeof t,"isValidObject"),D=P((t,e,n={})=>{if(C(n)||(n={default:n}),!q(t))return void 0!==n.default?n.default:t;"number"==typeof e&&(e=String(e));const r=Array.isArray(e),i="string"==typeof e,o=n.separator||".",a=n.joinChar||("string"==typeof o?o:".");if(!i&&!r)return t;if(void 0!==t[e])return E(e,t,n)?t[e]:n.default;const s=r?e:B(e,o,n),c=s.length;let u=0;do{let e=s[u];for("string"!=typeof e&&(e=String(e));e&&"\\"===e.slice(-1);)e=N([e.slice(0,-1),s[++u]||""],a,n);if(void 0!==t[e]){if(!E(e,t,n))return n.default;t=t[e]}else{let r=!1,i=u+1;for(;i<c;)if(e=N([e,s[i++]],a,n),r=void 0!==t[e]){if(!E(e,t,n))return n.default;t=t[e],u=i-1;break}if(!r)return n.default}}while(++u<c&&q(t));return u===c?t:n.default},"getValue");function K(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function F(t){return function e(n){return 0===arguments.length||K(n)?e:t.apply(this,arguments)}}function U(t){return function e(n,r){switch(arguments.length){case 0:return e;case 1:return K(n)?e:F(function(e){return t(n,e)});default:return K(n)&&K(r)?e:K(n)?F(function(e){return t(e,r)}):K(r)?F(function(e){return t(n,e)}):t(n,r)}}}const L=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)};function R(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}function M(t,e,n){for(var r=0,i=n.length;r<i;){if(t(e,n[r]))return!0;r+=1}return!1}function z(t,e){return Object.prototype.hasOwnProperty.call(e,t)}const H="function"==typeof Object.is?Object.is:function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e};var V=Object.prototype.toString,$=function(){return"[object Arguments]"===V.call(arguments)?function(t){return"[object Arguments]"===V.call(t)}:function(t){return z("callee",t)}}(),G=!{toString:null}.propertyIsEnumerable("toString"),W=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Z=function(){return arguments.propertyIsEnumerable("length")}(),J=function(t,e){for(var n=0;n<t.length;){if(t[n]===e)return!0;n+=1}return!1},X="function"!=typeof Object.keys||Z?F(function(t){if(Object(t)!==t)return[];var e,n,r=[],i=Z&&$(t);for(e in t)!z(e,t)||i&&"length"===e||(r[r.length]=e);if(G)for(n=W.length-1;n>=0;)z(e=W[n],t)&&!J(r,e)&&(r[r.length]=e),n-=1;return r}):F(function(t){return Object(t)!==t?[]:Object.keys(t)}),Q=F(function(t){return null===t?"Null":void 0===t?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function Y(t,e,n,r){var i=R(t);function o(t,e){return tt(t,e,n.slice(),r.slice())}return!M(function(t,e){return!M(o,e,t)},R(e),i)}function tt(t,e,n,r){if(H(t,e))return!0;var i,o,a=Q(t);if(a!==Q(e))return!1;if("function"==typeof t["fantasy-land/equals"]||"function"==typeof e["fantasy-land/equals"])return"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](e)&&"function"==typeof e["fantasy-land/equals"]&&e["fantasy-land/equals"](t);if("function"==typeof t.equals||"function"==typeof e.equals)return"function"==typeof t.equals&&t.equals(e)&&"function"==typeof e.equals&&e.equals(t);switch(a){case"Arguments":case"Array":case"Object":if("function"==typeof t.constructor&&"Promise"===(i=t.constructor,null==(o=String(i).match(/^function (\w*)/))?"":o[1]))return t===e;break;case"Boolean":case"Number":case"String":if(typeof t!=typeof e||!H(t.valueOf(),e.valueOf()))return!1;break;case"Date":if(!H(t.valueOf(),e.valueOf()))return!1;break;case"Error":return t.name===e.name&&t.message===e.message;case"RegExp":if(t.source!==e.source||t.global!==e.global||t.ignoreCase!==e.ignoreCase||t.multiline!==e.multiline||t.sticky!==e.sticky||t.unicode!==e.unicode)return!1}for(var s=n.length-1;s>=0;){if(n[s]===t)return r[s]===e;s-=1}switch(a){case"Map":return t.size===e.size&&Y(t.entries(),e.entries(),n.concat([t]),r.concat([e]));case"Set":return t.size===e.size&&Y(t.values(),e.values(),n.concat([t]),r.concat([e]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var c=X(t);if(c.length!==X(e).length)return!1;var u=n.concat([t]),l=r.concat([e]);for(s=c.length-1;s>=0;){var f=c[s];if(!z(f,e)||!tt(e[f],t[f],u,l))return!1;s-=1}return!0}var et=U(function(t,e){return tt(t,e,[],[])});var nt=F(function(t){return null!=t&&"function"==typeof t["fantasy-land/empty"]?t["fantasy-land/empty"]():null!=t&&null!=t.constructor&&"function"==typeof t.constructor["fantasy-land/empty"]?t.constructor["fantasy-land/empty"]():null!=t&&"function"==typeof t.empty?t.empty():null!=t&&null!=t.constructor&&"function"==typeof t.constructor.empty?t.constructor.empty():t==Set||t instanceof Set?new Set:t==Map||t instanceof Map?new Map:L(t)?[]:function(t){return"[object String]"===Object.prototype.toString.call(t)}(t)?"":function(t){return"[object Object]"===Object.prototype.toString.call(t)}(t)?{}:$(t)?function(){return arguments}():function(t){var e=Object.prototype.toString.call(t);return"[object Uint8ClampedArray]"===e||"[object Int8Array]"===e||"[object Uint8Array]"===e||"[object Int16Array]"===e||"[object Uint16Array]"===e||"[object Int32Array]"===e||"[object Uint32Array]"===e||"[object Float32Array]"===e||"[object Float64Array]"===e||"[object BigInt64Array]"===e||"[object BigUint64Array]"===e}(t)?t.constructor.from(""):void 0}),rt=F(function(t){return null!=t&&et(t,nt(t))});const it=t=>!(t=>void 0===t)(t),ot=new x(w);function at(t){return D(t,"traits.event_id")||D(t,"context.traits.event_id")||D(t,"properties.event_id")||t.messageId}const st=t=>t&&(t[w]||t[v]),ct=t=>{let e=t;if(Array.isArray(e)&&(e=e.map(String).join(",")),e&&"string"!=typeof e&&"object"!=typeof e&&(e=String(e)),!e||"string"==typeof e||Array.isArray(e)||"object"!=typeof e)return e;ot.error("'properties.category' must be either be a string or an array")},ut=(t,e)=>{const n={},r=t&&"object"==typeof t?t:{},i=e&&"object"==typeof e?e:{};return Object.keys(r).forEach(t=>{Object.hasOwn(r,t)&&(n[t]=r[t])}),Object.keys(i).forEach(t=>{Object.hasOwn(i,t)&&!Object.hasOwn(n,t)&&(n[t]=i[t])}),n},lt=t=>{const e=parseFloat(t),n=Number.isNaN(e)?0:parseFloat(e.toFixed(2));return Number.isNaN(n)&&ot.error("Revenue could not be converted to a number"),n},ft=(t,e,n)=>{const r=st(t.message.integrations),i=r?.contentType;if(i)return i;const o=t.message.properties;if(o&&"object"==typeof o){const{category:t}=o;if(t){const e=n?.find(e=>e.from===t);if(e?.to)return e.to}}return e},dt=(t,e,n,r)=>{const i=t?t.filter(t=>t).map(({product_id:t,sku:i,id:o,quantity:a,price:s,delivery_category:c})=>{const u=t||i||o;return it(u)?{id:u,quantity:a||e||1,item_price:s||n,delivery_category:c||r}:null}).filter(t=>null!==t):[],o=i.map(t=>t.id);return{contents:i,contentIds:o}},yt=(t,e,n)=>{const r=[],i=[];return t&&(i.push(t),r.push({id:t,quantity:e,item_price:n})),{contents:r,contentIds:i}},pt=t=>t||"",ht=t=>t||"USD",gt=t=>t?.properties||{},bt=(t,e,n)=>t||e||n,mt=(t,e)=>t||e||"",vt=(t,e)=>t||lt(e),wt=t=>"Product Viewed"===t?"ViewContent":"AddToCart",jt=(t,e,n)=>t?e:lt(n),St=(t,e,n)=>!t[n?.toLowerCase()]&&!e[n?.toLowerCase()],At=t=>{it(t)||ot.error("'properties.revenue' could not be converted to a number")},xt=(t,e="from",n="to",r=!0)=>{const i={};return Array.isArray(t)&&t.forEach(t=>{var o;(o=t[e],rt(o))||(i[r?t[e].toLowerCase():t[e]]=t[n])}),i};for(var It=256;It--;)(It+256).toString(16).substring(1);for(var _t=0;_t<256;_t++)(_t+256).toString(16).substring(1);const Ot=new x("Utils"),kt=t=>it(t)&&(t=>null!==t)(t),Tt=({message:t,operationObject:e})=>{const{operation:n,args:r}=e,i=r.map(e=>{const{sourceKeys:n,defaultVal:r}=e,i=D(t,n);return i||!1===i||0===i?i:r});if(!i.every(t=>kt(t)))return null;let o=null;switch(n){case"multiplication":o=1;for(const t of i){if("number"!=typeof t)return null;o*=t}return o.toFixed(2);case"addition":o=0;for(const t of i){if("number"!=typeof t)return null;o+=t}return o.toFixed(2);default:return null}},Pt=(t,e)=>{let n=t;const r={jsonStringify:()=>{n=JSON.stringify(t)},jsonStringifyOnObject:()=>{"string"!=typeof t&&(n=JSON.stringify(t))},toString:()=>{n=String(t)},toNumber:()=>{n=Number(t)},toFloat:()=>{n=parseFloat(t)},toInt:()=>{n=parseInt(t,10)},toLower:()=>{n=t.toString().toLowerCase()},trim:()=>{"string"==typeof t&&(n=t.trim())},IsBoolean:()=>{n=!0,"boolean"!=typeof t&&(Ot.debug("Boolean value missing, so dropping it"),n=!1)}};if(e in r){(0,r[e])()}return n},Ct=(t,e)=>{const n={};return Array.isArray(e)&&e.length>0&&e.forEach(e=>{const{sourceKeys:r,destKey:i,metadata:o}=e,a=((t,e)=>{if(!e)return t;const{type:n,defaultValue:r}=e;if(!kt(t))return r||t;let i=t;return n&&(Array.isArray(n)?n.forEach(t=>{i=Pt(i,t)}):i=Pt(i,n)),i})(((t,e)=>{if(Array.isArray(e)&&e.length>0){for(const n of e){let e;if(e="object"==typeof n?Tt({message:t,operationObject:n}):D(t,n),e||!1===e||0===e)return e}return null}return"object"==typeof e?Tt({message:t,operationObject:e}):D(t,e)})(t,r),o);(a||0===a||!1===a)&&i&&(n[i]=a)}),n},Nt=new x(w);return t.FacebookPixel=class{constructor(t,e,n){e.logLevel&&Nt.setLogLevel(e.logLevel),this.autoConfig=void 0===t.autoConfig||t.autoConfig,this.blacklistPiiProperties=t.blacklistPiiProperties,this.categoryToContent=t.categoryToContent||[],this.pixelId=t.pixelId,this.eventsToEvents=t.eventsToEvents,this.valueFieldIdentifier=t.valueFieldIdentifier,this.advancedMapping=t.advancedMapping,this.traitKeyToExternalId=t.traitKeyToExternalId,this.legacyConversionPixelId=t.legacyConversionPixelId||[],this.userIdAsPixelId=t.userIdAsPixelId||[],this.whitelistPiiProperties=t.whitelistPiiProperties,this.useUpdatedMapping=t.useUpdatedMapping,this.name=v,this.analytics=e,({shouldApplyDeviceModeTransformation:this.shouldApplyDeviceModeTransformation,propagateEventsUntransformedOnError:this.propagateEventsUntransformedOnError,destinationId:this.destinationId}=n??{})}init(){if(window._fbq=function(){window.fbq.callMethod?window.fbq.callMethod.apply(window.fbq,arguments):window.fbq.queue.push(arguments)},window.fbq=window.fbq||window._fbq,window.fbq.push=window.fbq,window.fbq.loaded=!0,window.fbq.disablePushState=!0,window.fbq.allowDuplicatePageViews=!0,window.fbq.version="2.0",window.fbq.queue=[],window.fbq("set","autoConfig",this.autoConfig,this.pixelId),this.advancedMapping){if(this.useUpdatedMapping){const t={context:{traits:{...this.analytics.getUserTraits()}},userId:this.analytics.getUserId(),anonymousId:this.analytics.getAnonymousId()},e=Ct(t,j);S.forEach(e=>{delete t.context?.traits[e]}),this.userPayload={...e,...t.context.traits},this.userPayload.external_id&&(this.userPayload.external_id=m(this.userPayload.external_id).toString())}else this.userPayload={...this.analytics.getUserTraits()};window.fbq("init",this.pixelId,this.userPayload)}else window.fbq("init",this.pixelId);((t,e,n={})=>{if(document.getElementById(t))return;const r=document.createElement("script");r.src=e,r.async=void 0===n.async||n.async,r.type="text/javascript",r.id=t,!0!==n.skipDatasetAttributes&&(r.setAttribute("data-loader","RS_JS_SDK"),void 0!==n.isNonNativeSDK&&r.setAttribute("data-isNonNativeSDK",n.isNonNativeSDK));const i=document.getElementsByTagName("head");if(i.length>0)i[0].insertBefore(r,i[0].firstChild);else{const t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(r,t)}})("fbpixel-integration","https://connect.facebook.net/en_US/fbevents.js")}isLoaded(){return!!window.fbq?.callMethod}isReady(){return this.isLoaded()}page(t){const{properties:e}=t.message;window.fbq("track","PageView",e,{eventID:at(t.message)})}track(t){const{event:e}=t.message,n=gt(t.message),{id:r,sku:i,name:o,price:a,query:s,revenue:c,products:u,quantity:l,contentName:f,product_id:d,product_name:y,delivery_category:p,content_type:h}=n;let{value:g,category:b,currency:v}=n;const w=lt(c);At(w),v=ht(v);const j=((t,e,n,r)=>{const i=["checkinDate","checkoutDate","departingArrivalDate","departingDepartureDate","returningArrivalDate","returningDepartureDate","travelEnd","travelStart"],o=["email","firstName","lastName","gender","city","country","phone","state","zip","birthday"],a=e||[],s=(n||[]).reduce((t,e)=>(t[e.blacklistPiiProperties]=e.blacklistPiiHash,t),{}),c=a.map(t=>t.whitelistPiiProperties),{properties:u}=t.message;return u&&"object"==typeof u?Object.entries(u).reduce((t,[e,n])=>{const a=o.includes(e)||Object.hasOwn(s,e),u=c.includes(e),l=i.includes(e)&&k.date(n);return l&&([t[e]]=n.toISOString().split("T")),s[e]&&"string"==typeof n?t[e]=r?n.toString():m(n).toString():a&&!u||l?ot.info(`PII Property '${n}' is neither hashed nor whitelisted and will be ignored`):t[e]=n,t},{}):{}})(t,this.whitelistPiiProperties,this.blacklistPiiProperties,(t=>{const e=st(t.integrations),n=e?.hashed;return n})(t.message)),S=this.eventsToEvents,A=this.legacyConversionPixelId,x=xt(S),I=xt(A),_="properties.value"===this.valueFieldIdentifier,O=bt(d,i,r);if(g=vt(w,g),b&&!ct(b))return;b=ct(b);const T=at(t.message);if("Product List Viewed"===e){const{contentIds:r,contentType:i,contents:o}=(t=>{if(!t||"object"!=typeof t)return{};let{products:e,category:n,quantity:r,price:i}=t;Array.isArray(e)||(e=[e]);const{contents:o,contentIds:a}=dt(e,r,i);let s;return a.length>0?s="product":n&&(a.push(n),o.push({id:n,quantity:1}),s="product_group"),{contentIds:a,contentType:s,contents:o}})(n),a={content_ids:r,content_type:h||ft(t,i,this.categoryToContent),contents:o,content_category:pt(b),content_name:f,value:g,currency:v};this.makeTrackSignalCall(this.pixelId,"ViewContent",ut(a,j),T),this.makeTrackSignalCalls(this.pixelId,e,I,T,{currency:v,value:w})}else if("Product Viewed"===e||"Product Added"===e){const{contents:n,contentIds:r}=yt(O,l,a),i={content_ids:r,content_type:h||ft(t,"product",this.categoryToContent),content_name:mt(y,o),content_category:pt(b),currency:v,value:jt(_,g,a),contents:n};this.makeTrackSignalCall(this.pixelId,wt(e),ut(i,j),T),this.makeTrackSignalCalls(this.pixelId,e,I,T,{currency:v,value:i.value})}else if("Order Completed"===e){const{contents:n,contentIds:r}=dt(u,l,a,p),i={content_ids:r,content_type:h||ft(t,"product",this.categoryToContent),currency:v,value:w,contents:n,num_items:r.length,content_name:f};this.makeTrackSignalCall(this.pixelId,"Purchase",ut(i,j),T),this.makeTrackSignalCalls(this.pixelId,e,I,T,{currency:v,value:w})}else if("Products Searched"===e){const{contents:t,contentIds:n}=yt(O,l,a),r={content_ids:n,content_category:pt(b),currency:v,value:g,contents:t,search_string:s};this.makeTrackSignalCall(this.pixelId,"Search",ut(r,j),T),this.makeTrackSignalCalls(this.pixelId,e,I,T,{currency:v,value:g})}else if("Checkout Started"===e){let n=b;const{contents:r,contentIds:i}=dt(u,l,a);Array.isArray(u)&&!n&&u[0]?.category&&(n=u[0].category);const o={content_ids:i,content_type:h||ft(t,"product",this.categoryToContent),content_category:n,currency:v,value:w,contents:r,num_items:i.length};this.makeTrackSignalCall(this.pixelId,"InitiateCheckout",ut(o,j),T),this.makeTrackSignalCalls(this.pixelId,e,I,T,{currency:v,value:w})}else St(x,I,e)?(j.value=w,window.fbq("trackSingleCustom",this.pixelId,e,j,{eventID:T})):(Nt.info("Not standard event & no custom mapping available"),j.value=w,j.currency=v,this.makeTrackSignalCalls(this.pixelId,e,x,T,j),this.makeTrackSignalCalls(this.pixelId,e,I,T,{currency:v,value:w}))}makeTrackSignalCalls(t,e,n,r,i){l((n,o)=>{o===e.toLowerCase()&&window.fbq("trackSingle",t,n,i,{eventID:r})},n)}makeTrackSignalCall(t,e,n,r){window.fbq("trackSingle",t,e,n,{eventID:r})}},Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),t}({});
//# sourceMappingURL=FacebookPixel.min.js.map
